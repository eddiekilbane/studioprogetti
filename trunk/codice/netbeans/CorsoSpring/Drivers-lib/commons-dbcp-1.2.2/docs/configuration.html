<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html><head><title>Configuration - Commons DBCP</title><style type="text/css" media="all">
          @import url("./style/maven-base.css");
          
          @import url("./style/maven-theme.css");@import url("./style/project.css");</style><link rel="stylesheet" href="./style/print.css" type="text/css" media="print"></link><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"></meta><meta name="author" content="Commons Documentation Team"></meta><meta name="email" content="commons-dev@jakarta.apache.org"></meta></head><body class="composite"><div id="banner"><a href="http://jakarta.apache.org" id="organizationLogo"><img alt="The Apache Software Foundation" src="http://jakarta.apache.org/images/jakarta-logo.gif"></img></a><a href="http://jakarta.apache.org/commons/dbcp/" id="projectLogo"><img alt="Commons DBCP" src="./images/dbcp-logo-white.png"></img></a><div class="clear"><hr></hr></div></div><div id="breadcrumbs"><div class="xleft"></div><div class="xright">
        
        <a href="http://www.apache.org" class="externalLink" title="External Link">Apache</a>
      
        
          
            <span class="separator">|</span>
          
        
        <a href="http://jakarta.apache.org" class="externalLink" title="External Link">Jakarta</a>
      
        
          
            <span class="separator">|</span>
          
        
        <a href="http://jakarta.apache.org/commons/" class="externalLink" title="External Link">Commons</a>
      </div><div class="clear"><hr></hr></div></div><div id="leftColumn"><div id="navcolumn"><div id="menuCommons DBCP"><h5>Commons DBCP</h5><ul><li class="none"><a href="index.html">Overview</a></li><li class="none"><strong><a href="configuration.html">Configuration</a></strong></li><li class="none"><a href="apidocs/index.html">API Documentation</a></li><li class="collapsed"><a href="guide/index.html">Developers Guide</a></li><li class="none"><a href="http://svn.apache.org/viewcvs.cgi/jakarta/commons/proper/dbcp/trunk/doc/" class="externalLink" title="External Link">Examples</a></li><li class="none"><a href="downloads.html">Downloads</a></li><li class="none"><a href="http://wiki.apache.org/jakarta-commons/DBCP" class="externalLink" title="External Link">Wiki</a></li></ul></div><div id="menuDevelopment"><h5>Development</h5><ul><li class="none"><a href="changes-report.html">History</a></li><li class="none"><a href="building.html">Building</a></li><li class="none"><a href="mail-lists.html">Mailing lists</a></li><li class="none"><a href="issue-tracking.html">Issue Tracking</a></li><li class="none"><a href="team-list.html">Team</a></li><li class="none"><a href="cvs-usage.html">Source repository</a></li></ul></div><div id="menuProject_Documentation"><h5>Project Documentation</h5><ul><li class="none"><a href="index.html">About</a></li><li class="collapsed"><a href="project-info.html">Project Info</a></li><li class="collapsed"><a href="maven-reports.html">Project Reports</a></li><li class="none"><a href="http://jakarta.apache.org/commons/charter.html" class="externalLink" title="External Link">Development Process</a></li></ul></div><div id="menuCommons"><h5>Commons</h5><ul><li class="none"><a href="http://jakarta.apache.org/commons/" class="externalLink" title="External Link">Home</a></li><li class="collapsed"><a href="http://jakarta.apache.org/commons/components.html" class="externalLink" title="External Link">Components</a></li><li class="collapsed"><a href="http://jakarta.apache.org/commons/sandbox/index.html" class="externalLink" title="External Link">Sandbox</a></li><li class="collapsed"><a href="http://jakarta.apache.org/commons/dormant/index.html" class="externalLink" title="External Link">Dormant</a></li><li class="none"><a href="http://jakarta.apache.org/commons/volunteering.html" class="externalLink" title="External Link">Volunteering</a></li><li class="none"><a href="http://jakarta.apache.org/commons/patches.html" class="externalLink" title="External Link">Contributing Patches</a></li><li class="none"><a href="http://jakarta.apache.org/commons/building.html" class="externalLink" title="External Link">Building Components</a></li><li class="none"><a href="http://jakarta.apache.org/commons/releases/index.html" class="externalLink" title="External Link">Releasing Components</a></li><li class="none"><a href="http://wiki.apache.org/jakarta-commons/FrontPage" class="externalLink" title="External Link">Wiki</a></li></ul></div><div id="legend"><h5>Legend</h5><ul><li class="externalLink">External Link</li><li class="newWindow">Opens in a new window</li></ul></div><a href="http://maven.apache.org/" title="Built by Maven" id="poweredBy"><img alt="Built by Maven" src="./images/logos/maven-feather.png"></img></a></div></div><div id="bodyColumn"><div class="contentBox"><div class="section"><a name="Parameters"></a><h2>Parameters</h2>

<table class="bodyTable">
<hr><th>Parameter</th><th>Description</th></hr>
<tr class="b">
   <td>username</td>
   <td>The connection username to be passed to our JDBC driver to establish a connection.</td>
</tr>
<tr class="a">
   <td>password</td>
   <td>The connection password to be passed to our JDBC driver to establish a connection.</td>
</tr>
<tr class="b">
   <td>url</td>
   <td>The connection URL to be passed to our JDBC driver to establish a connection.</td>
</tr>
<tr class="a">
   <td>driverClassName</td>
   <td>The fully qualified Java class name of the JDBC driver to be used.</td>
</tr>
<tr class="b">
   <td>connectionProperties</td>
   <td>The connection properties that will be sent to our JDBC driver when establishing new connections.
       <br></br>Format of the string must be [propertyName=property;]*
       <br></br><strong>NOTE</strong> - The "user" and "password" properties will be passed explicitly, 
       so they do not need to be included here.
   </td>
</tr>
</table>


<table class="bodyTable">
<hr><th>Parameter</th><th>Default</th><th>Description</th></hr>
<tr class="a">
   <td>defaultAutoCommit</td>
   <td>true</td>
   <td>The default auto-commit state of connections created by this pool.</td>
</tr>
<tr class="b">
   <td>defaultReadOnly</td>
   <td>driver default</td>
   <td>The default read-only state of connections created by this pool.
       If not set then the setReadOnly method will not be called.
       (Some drivers don't support read only mode, ex: Informix)
   </td>
</tr>
<tr class="a">
   <td>defaultTransactionIsolation</td>
   <td>driver default</td>
   <td>The default TransactionIsolation state of connections created by this pool.
       One of the following: (see 
       <a href="http://java.sun.com/j2se/1.4.2/docs/api/java/sql/Connection.html#field_summary" class="externalLink" title="External Link">javadoc</a>)
       <ul>
          <li>NONE</li>
          <li>READ_COMMITTED</li>
          <li>READ_UNCOMMITTED</li>
          <li>REPEATABLE_READ</li>
          <li>SERIALIZABLE</li>
       </ul>
   </td>
</tr>
<tr class="b">
   <td>defaultCatalog</td>
   <td></td>
   <td>The default catalog of connections created by this pool.</td>
</tr>
</table>


<table class="bodyTable">
<hr><th>Parameter</th><th>Default</th><th>Description</th></hr>
<tr class="a">
   <td>initialSize</td>
   <td>0</td>
   <td>
      The initial number of connections that are created when the pool
      is started.
      <br></br>Since: 1.2
   </td>
</tr>
<tr class="b">
   <td>maxActive</td>
   <td>8</td>
   <td>
      The maximum number of active connections that can be allocated from
      this pool at the same time, or non-positive for no limit.
   </td>
</tr>
<tr class="a">
   <td>maxIdle</td>
   <td>8</td>
   <td>
      The maximum number of connections that can remain idle in the
      pool, without extra ones being released, or negative for no limit.
   </td>
</tr>
<tr class="b">
   <td>minIdle</td>
   <td>0</td>
   <td>
      The minimum number of connections that can remain idle in the
      pool, without extra ones being created, or zero to create none.
   </td>
</tr>
<tr class="a">
   <td>maxWait</td>
   <td>indefinitely</td>
   <td>
      The maximum number of milliseconds that the pool will wait (when there
      are no available connections) for a connection to be returned before
      throwing an exception, or -1 to wait indefinitely.
   </td>
</tr>
</table>


<table class="bodyTable">
<hr><th>Parameter</th><th>Default</th><th>Description</th></hr>
<tr class="b">
   <td>validationQuery</td>
   <td></td>
   <td>
The SQL query that will be used to validate connections from this pool
before returning them to the caller.  If specified, this query
<strong>MUST</strong> be an SQL SELECT statement that returns at least
one row.
   </td>
</tr>
<tr class="a">
   <td>testOnBorrow</td>
   <td>true</td>
   <td>
      The indication of whether objects will be validated before being
      borrowed from the pool.  If the object fails to validate, it will be
      dropped from the pool, and we will attempt to borrow another.<br></br>
      <strong>NOTE</strong> - for a <code>true</code> value to have any effect,
      the <code>validationQuery</code> parameter must be set to a non-null
      string.
   </td>
</tr>
<tr class="b">
   <td>testOnReturn</td>
   <td>false</td>
   <td>
      The indication of whether objects will be validated before being
      returned to the pool. <br></br> <strong>NOTE</strong> - for a 
      <code>true</code> value to have any effect, the 
      <code>validationQuery</code> parameter must be set to a non-null string.
   </td>
</tr>
<tr class="a">
   <td>testWhileIdle</td>
   <td>false</td>
   <td>
      The indication of whether objects will be validated by the idle object
      evictor (if any).  If an object fails to validate, it will be dropped
      from the pool. <br></br> <strong>NOTE</strong> - for a <code>true</code>
      value to have any effect, the <code>validationQuery</code> parameter
      must be set to a non-null string.
   </td>
</tr>
<tr class="b">
   <td>timeBetweenEvictionRunsMillis</td>
   <td>-1</td>
   <td>
      The number of milliseconds to sleep between runs of the idle object
      evictor thread.  When non-positive, no idle object evictor thread will
      be run.
   </td>
</tr>
<tr class="a">
   <td>numTestsPerEvictionRun</td>
   <td>3</td>
   <td>
      The number of objects to examine during each run of the idle object
      evictor thread (if any).
   </td>
</tr>
<tr class="b">
   <td>minEvictableIdleTimeMillis</td>
   <td>1000 * 60 * 30</td>
   <td>
      The minimum amount of time an object may sit idle in the pool before it
      is eligable for eviction by the idle object evictor (if any).
   </td>
</tr>
</table>

<table class="bodyTable">
<hr><th>Parameter</th><th>Default</th><th>Description</th></hr><tr class="a">
   <td>poolPreparedStatements</td>
   <td>false</td>
   <td>Enable prepared statement pooling for this pool.</td>
</tr>
<tr class="b">
   <td>maxOpenPreparedStatements</td>
   <td>unlimited</td>
   <td>
      The maximum number of open statements that can be allocated from
      the statement pool at the same time, or zero for no limit.
   </td>
</tr>
</table>
<p>
<img src="images/icon_info_sml.gif" alt=""></img>
This component has also the ability to pool PreparedStatements.
When enabled a statement pool will be created for each Connection
and PreparedStatements created by one of the following methods will be pooled:
<ul>
   <li>public PreparedStatement prepareStatement(String sql)</li>
   <li>public PreparedStatement prepareStatement(String sql, int resultSetType, int resultSetConcurrency)</li>
</ul>
</p>
<p>
<img src="images/icon_warning_sml.gif" alt=""></img>
<strong>NOTE</strong> - Make sure your connection has some resources left for the other statements.
</p>


<table class="bodyTable">
<hr><th>Parameter</th><th>Default</th><th>Description</th></hr><tr class="a">
   <td>accessToUnderlyingConnectionAllowed</td>
   <td>false</td>
   <td>Controls if the PoolGuard allows access to the underlying connection.</td>
</tr>
</table>
<p>When allowed you can access the underlying connection using the following construct:</p>

    <div class="source"><pre>
    Connection conn = ds.getConnection();
    Connection dconn = ((DelegatingConnection) conn).getInnermostDelegate();
    ...
    conn.close()
</pre></div>
  
<p>
<img src="images/icon_info_sml.gif" alt=""></img>
Default is false, it is a potential dangerous operation and misbehaving programs can do harmfull things. (closing the underlying or continue using it when the guarded connection is already closed)
Be carefull and only use when you need direct access to driver specific extentions.
</p>
<p>
<img src="images/icon_warning_sml.gif" alt=""></img>
<b>NOTE:</b> Do not close the underlying connection, only the original one.
</p>


<table class="bodyTable">
<hr><th>Parameter</th><th>Default</th><th>Description</th></hr>
<tr class="b">
   <td>removeAbandoned</td>
   <td>false</td>
   <td>
      Flag to remove abandoned connections if they exceed the
      removeAbandonedTimout.<br></br>
      If set to true a connection is considered abandoned and eligible
      for removal if it has been idle longer than the removeAbandonedTimeout.
      Setting this to true can recover db connections from poorly written
      applications which fail to close a connection.
   </td>
</tr>
<tr class="a">
   <td>removeAbandonedTimeout</td>
   <td>300</td>
   <td>Timeout in seconds before an abandoned connection can be removed.</td>
</tr>
<tr class="b">
   <td>logAbandoned</td>
   <td>false</td>
   <td>
      Flag to log stack traces for application code which abandoned
      a Statement or Connection.<br></br>
      Logging of abandoned Statements and Connections adds overhead
      for every Connection open or new Statement because a stack   
      trace has to be generated.  
   </td>
</tr>
</table>
<p>
<img src="images/icon_info_sml.gif" alt=""></img>
If you have enabled "removeAbandoned" then it is possible that a connection is reclaimed by the pool because it is considered to be abandoned.
This mechanism is triggered when (getNumIdle() &lt; 2) and (getNumActive() &gt; getMaxActive() - 3)
</p>
<p>
<img src="images/icon_info_sml.gif" alt=""></img>
For example maxActive=20 and 18 active connections and 1 idle connection would trigger the "removeAbandoned".
But only the active connections that aren't used for more then "removeAbandonedTimeout" seconds are removed,
default (300 sec). Traversing a resultset doesn't count as being used. 
</p>

</div></div></div><div class="clear"><hr></hr></div><div id="footer"><div class="xright">© 2001-2007, The Apache Software Foundation© -Last published: 25 March 2007
            </div><div class="clear"><hr></hr></div></div></body></html>